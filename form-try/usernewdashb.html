<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User / PLP Clinic Monitoring System</title>
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../form-user-css/usernewdashbstyle.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <link rel="icon" type="image/png" href="../pictures/logo.png" />
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  </head>
  <body>
    <div class="background"></div>
      <header class="head">
        <div class="logo-container">
            <img src="../pictures/logo_user.png" alt="Logo" class="logo">
        </div>
        
        <div class="user-info">
            
            <span class="email">user@example.com</span>
            <span class="material-icons" id="user-info">
            account_circle
            </span>
        <span class="material-icons" id="logout-btn">
        logout
        </span>
        </div>
    </header>
   <nav class="container">
  <div class="navigation_main">
    <button class="dashb active" data-url="../form-try/usernewdashb.html">Dashboard</button>
    <button class="medrec" data-url="../form-try/usermedhist.html">Medical Records</button>
    <button class="borrow" data-url="../form-try/usermedborrow.html">Borrow</button>
  </div>

  <script>
    const buttons = document.querySelectorAll('.navigation_main button');
    
    buttons.forEach(button => {
      button.addEventListener('click', function () {
        buttons.forEach(btn => btn.classList.remove('active'));
        this.classList.add('active');

        const url = this.getAttribute('data-url');
        if (url) {
          window.location.href = url; // redirect to the new page
        }
      });
    });
  </script>
</nav>


    <section class="main">

        <div class="info">
        <div class="header-name" id="greeting"></div>

      <div class="status-container" id="patient-info">
  <aside class="status-box">
    <div class="status-row">
      <div class="status-column">
        <p><strong>Patient Name:</strong> <span id="patient-name">Loading...</span></p>
        <p><strong>Birthdate:</strong> <span id="patient-id">Loading...</span></p>
      </div>
      <div class="status-column">
        <p><strong>Role:</strong> <span id="patient-role">Loading...</span></p>
        <p><strong>Age:</strong> <span id="patient-age">Loading...</span></p>

      </div>
      <div class="status-column">
        <p><strong>Sex:</strong> <span id="patient-sex">Loading...</span></p>
      </div>
    </div>
        </div>
        </div>
        <div class="notif">hi</div>
    </section>

    <button class="emerg">
        PASIG EMERGENCY HOTLINES
    </button>

 <section class="text">
    <div class="text-divider">AVAILABLE ITEMS</div>
  </section>

 <div class="items">
        <div class="item">
          
        </div>
        
        <div class="item">
           
        </div>
        
        <div class="item">
           
        </div>
        
        <div class="item">
           
        </div>
        
        <div class="item">
           
        </div>
          
        
        <div class="item">
           
        </div>
        <div class="item">
           
        </div>
         <div class="item">
           
        </div>
        
    </div>
  </body>

  <script>
      
    function updateGreeting(name) {
      const now = new Date();
      const philTime = new Date(
        now.toLocaleString("en-US", { timeZone: "Asia/Manila" })
      );
      const hours = philTime.getHours();

      let greeting;
      if (hours >= 5 && hours < 12) {
        greeting = "Good Morning";
      } else if (hours >= 12 && hours < 18) {
        greeting = "Good Afternoon";
      } else {
        greeting = "Good Evening";
      }

      document.getElementById("greeting").innerText = `${greeting}, ${name}!`;
    }

    document.addEventListener("DOMContentLoaded", () => {
      updateGreeting("John");
    });


    </script>

<!--
  
 document.addEventListener("DOMContentLoaded", function () {
  fetch('../php/userinterfacefetch.php')
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        const p = data.patient;

        document.getElementById('patient-name').textContent =
          `${p.First_Name} ${p.Middle_Name || ''} ${p.Last_Name}`;
        document.getElementById('patient-id').textContent = p.Birthdate;
        document.getElementById('patient-role').textContent = p.Category;
        document.getElementById('patient-sex').textContent = p.Sex;
        document.getElementById('patient-age').textContent = data.age;
        document.getElementById('patient-email').textContent = data.email;

        // Update greeting
        updateGreeting(`${p.First_Name} ${p.Last_Name}`);
      } else {
        document.getElementById('patient-info').innerHTML =
          `<p>Unable to load patient data: ${data.message || 'Unknown error'}</p>`;
      }
    })
    .catch(error => {
      console.error("Error fetching patient data:", error);
      document.getElementById('patient-info').innerHTML =
        "<p>Error loading data. Please try again later.</p>";
    });
    
  

 



      let btn = document.querySelector("#logo");
      let sidebar = document.querySelector(".sidebar");

      btn.onclick = function () {
        sidebar.classList.toggle("active");
      };

      

</script>
document.addEventListener("DOMContentLoaded", function () {
  const tbody = document.getElementById("borrowedItemsBody");
  const itemsPerPage = 5;
  let currentPage = 1;
  let allItems = [];

  function renderTablePage(page) {
    tbody.innerHTML = "";

    const start = (page - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginatedItems = allItems.slice(start, end);

    if (paginatedItems.length === 0) {
      tbody.innerHTML = `<tr><td colspan="8" style="text-align: center; padding: 20px;">No borrowed items found.</td></tr>`;
      document.querySelector('.pagination').style.display = 'none';
      return;
    }

    document.querySelector('.pagination').style.display = 'flex';
    paginatedItems.forEach((item, index) => {
      let borrowedImg = item.Photo_Borrowed || 'no-image.png';
      let returnedImg = item.Photo_Returned;

      const row = `<tr>
      <td>${start + index + 1}</td>
      <td>${item.Date_Borrowed || "-"}</td>
      <td>${item.Date_Returned || "-"}</td>
      <td>${item.Item_Name}</td>
      <td>${item.Quantity}</td>
      <td>
        ${item.Status === 'Returned-Undamaged' ? 'Returned (Good)' :
          item.Status === 'Returned-Damaged' ? 'Returned (Damage)' :
          item.Status || '-'}
      </td>
      <td><img src="../uploads/${borrowedImg}" width="60" onerror="this.src='../pictures/no-image.png'"></td>
      <td>${returnedImg ? `<img src="../uploads/${returnedImg}" width="60" onerror="this.src='../pictures/no-image.png'">` : 'Not yet returned'}</td>
    </tr>`;
      tbody.innerHTML += row;
    });
  }

  // Fetch borrowed items directly using session Patient_ID
  fetch("../php/fetch_borrowed_items.php")
    .then(response => {
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      return response.json();
    })
    .then(data => {
      if (data.error) {
        throw new Error(data.error);
      }
      allItems = data;
      renderTablePage(currentPage);
      updatePaginationButtons();
    })
    .catch(err => {
      console.error("Error:", err);
      tbody.innerHTML = `<tr><td colspan="8" style="text-align: center; padding: 20px;">
        ${err.message || 'Error loading data. Please try again later.'}</td></tr>`;
      document.querySelector('.pagination').style.display = 'none';
    });

  function updatePaginationButtons() {
    const totalPages = Math.ceil(allItems.length / itemsPerPage);
    const buttons = document.querySelectorAll(".page-btn");
    buttons.forEach(btn => {
      if (!isNaN(btn.textContent)) {
        const pageNum = parseInt(btn.textContent);
        btn.style.display = pageNum <= totalPages ? '' : 'none';
        btn.classList.toggle("active", pageNum === currentPage);
      }
    });
  }

  // Expose to global for button onclicks
  window.goToPage = function(page) {
    const totalPages = Math.ceil(allItems.length / itemsPerPage);

    if (page === 'prev') {
      if (currentPage > 1) currentPage--;
    } else if (page === 'next') {
      if (currentPage < totalPages) currentPage++;
    } else {
      currentPage = page;
    }

    updatePaginationButtons();
    renderTablePage(currentPage);
  };
});

</script>
-->


  </body>
</html>